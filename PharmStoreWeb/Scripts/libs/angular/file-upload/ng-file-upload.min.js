(function(){function e(n,t){window.XMLHttpRequest.prototype[n]=t(window.XMLHttpRequest.prototype[n])}function o(n,t,i,f,e,o){function h(){return t[0].tagName.toLowerCase()==="input"&&t.attr("type")&&t.attr("type").toLowerCase()==="file"}function l(t){var l,a;if(!s){s=!0;try{var v=t.__files_||t.target&&t.target.files,h=[],y=[];for(l=0;l<v.length;l++)a=v.item(l),u(n,e,i,a,t)?h.push(a):y.push(a);r(e,o,n,f,i,c,h,y,t);h.length==0&&(t.target.value=h)}finally{s=!1}}}function a(r){var f,u;for(i.ngfMultiple&&r.attr("multiple",e(i.ngfMultiple)(n)),e(i.ngfMultiple)(n)||r.attr("multiple",undefined),i.accept&&r.attr("accept",i.accept),i.ngfCapture&&r.attr("capture",e(i.ngfCapture)(n)),i.ngfDisabled&&r.attr("disabled",e(i.ngfDisabled)(n)),f=0;f<t[0].attributes.length;f++)u=t[0].attributes[f],u.name!=="type"&&u.name!=="class"&&u.name!=="id"&&u.name!=="style"&&r.attr(u.name,u.value)}function v(){if(!t.attr("disabled")){var n=angular.element('<input type="file">');return a(n),h()?(t.replaceWith(n),t=n):(n.css("display","none").attr("tabindex","-1").attr("__ngf_gen__",!0),t.__ngf_ref_elem__&&t.__ngf_ref_elem__.remove(),t.__ngf_ref_elem__=n,document.body.appendChild(n[0])),n}}function y(t){r(e,o,n,f,i,c,[],[],t,!0)}function p(n){n.preventDefault();var i=v(n);if(i){i.bind("change",l);y(n);function r(){i[0].click();h()&&(t.bind("click touchend",p),n.preventDefault())}navigator.userAgent.toLowerCase().match(/android/)?setTimeout(function(){r()},0):r()}}var c=i.ngfChange||i.ngfSelect&&i.ngfSelect.indexOf("(")>0,s=!1;window.FileAPI&&window.FileAPI.ngfFixIE?window.FileAPI.ngfFixIE(t,v,a,l,y):t.bind("click touchend",p)}function s(n,t,f,e,o,s,h){function w(n,t,i){var s=!0,e=i.dataTransfer.items,f,r;if(e!=null)for(f=0;f<e.length&&s;f++)s=s&&(e[f].kind=="file"||e[f].kind=="")&&u(n,o,t,e[f],i);return r=o(t.ngfDragOverClass)(n,{$event:i}),r&&(r.delay&&(p=r.delay),r.accept&&(r=s?r.accept:r.reject)),r||t.ngfDragOverClass||"dragover"}function b(t,i,r,e){function y(i){u(n,o,f,i,t)?l.push(i):k.push(i)}function g(n,t,i){var f,e,r,u;t!=null&&(t.isDirectory?(f=(i||"")+t.name,y({name:t.name,type:"directory",path:f}),e=t.createReader(),r=[],a++,u=function(){e.readEntries(function(f){try{if(f.length)r=r.concat(Array.prototype.slice.call(f||[],0)),u();else{for(var e=0;e<r.length;e++)g(n,r[e],(i?i:"")+t.name+"/");a--}}catch(o){a--;console.error(o)}},function(){a--})},u()):(a++,t.file(function(n){try{a--;n.path=(i?i:"")+n.name;y(n)}catch(t){a--;console.error(t)}},function(){a--})))}var l=[],k=[],v=t.dataTransfer.items,a=0,p,b,w,c,d;if(v&&v.length>0&&h.protocol()!="file")for(c=0;c<v.length;c++){if(v[c].webkitGetAsEntry&&v[c].webkitGetAsEntry()&&v[c].webkitGetAsEntry().isDirectory){if(p=v[c].webkitGetAsEntry(),p.isDirectory&&!r)continue;p!=null&&g(l,p)}else b=v[c].getAsFile(),b!=null&&y(b);if(!e&&l.length>0)break}else if(w=t.dataTransfer.files,w!=null)for(c=0;c<w.length;c++)if(y(w.item(c)),!e&&l.length>0)break;d=0,function nt(n){s(function(){if(a)d++*10<2e4&&nt(10);else{if(!e&&l.length>1){for(c=0;l[c].type=="directory";)c++;l=[l[c]]}i(l,k)}},n||0)}()}var a=i();if(f.dropAvailable&&s(function(){n[f.dropAvailable]?n[f.dropAvailable].value=a:n[f.dropAvailable]=a}),!a){o(f.ngfHideOnDropNotAvailable)(n)==!0&&t.css("display","none");return}var y=null,v=o(f.ngfStopPropagation),p=1,k=o(f.ngfAccept),l=o(f.ngfDisabled),c;t[0].addEventListener("dragover",function(i){if(!l(n)){if(i.preventDefault(),v(n)&&i.stopPropagation(),navigator.userAgent.indexOf("Chrome")>-1){var r=i.dataTransfer.effectAllowed;i.dataTransfer.dropEffect="move"===r||"linkMove"===r?"move":"copy"}s.cancel(y);n.actualDragOverClass||(c=w(n,f,i));t.addClass(c)}},!1);t[0].addEventListener("dragenter",function(t){l(n)||(t.preventDefault(),v(n)&&t.stopPropagation())},!1);t[0].addEventListener("dragleave",function(){l(n)||(y=s(function(){t.removeClass(c);c=null},p||1))},!1);t[0].addEventListener("drop",function(i){l(n)||(i.preventDefault(),v(n)&&i.stopPropagation(),t.removeClass(c),c=null,b(i,function(t,u){r(o,s,n,e,f,f.ngfChange||f.ngfDrop&&f.ngfDrop.indexOf("(")>0,t,u,i)},o(f.ngfAllowDir)(n)!=!1,f.multiple||o(f.ngfMultiple)(n)))},!1)}function i(){var n=document.createElement("div");return"draggable"in n&&"ondrop"in n}function r(n,t,i,r,u,f,e,o,s,h){function c(){r&&(n(u.ngModel).assign(i,e),t(function(){r&&r.$setViewValue(e!=null&&e.length==0?null:e)}));u.ngModelRejected&&n(u.ngModelRejected).assign(i,o);f&&n(f)(i,{$files:e,$rejectedFiles:o,$event:s})}h?c():t(function(){c()})}function u(n,t,i,r,u){var h=t(i.ngfAccept),c=t(i.ngfMaxSize)(n)||9007199254740991,l=t(i.ngfMinSize)(n)||-1,e=h(n,{$file:r,$event:u}),s=!1,o;return e!=null&&angular.isString(e)&&(o=new RegExp(f(e),"gi"),s=r.type!=null&&r.type.match(o)||r.name!=null&&r.name.match(o)),(e==null||s)&&(r.size==null||r.size<c&&r.size>l)}function f(n){var i,t,r;if(n.length>2&&n[0]==="/"&&n[n.length-1]==="/")return n.substring(1,n.length-1);if(i=n.split(","),t="",i.length>1)for(r=0;r<i.length;r++)t+="("+f(i[r])+")",r<i.length-1&&(t+="|");else n.indexOf(".")==0&&(n="*"+n),t="^"+n.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&")+"$",t=t.replace(/\\\*/g,".*").replace(/\\\?/g,".");return t}var n,t;window.XMLHttpRequest&&!window.XMLHttpRequest.__isFileAPIShim&&e("setRequestHeader",function(n){return function(t,i){if(t==="__setXHR_"){var r=i(this);r instanceof Function&&r(this)}else n.apply(this,arguments)}});t=angular.module("ngFileUpload",[]);t.version="4.0.4";t.service("Upload",["$http","$q","$timeout",function(t,i,r){function u(n){n.method=n.method||"POST";n.headers=n.headers||{};n.transformRequest=n.transformRequest||function(n,i){return window.ArrayBuffer&&n instanceof window.ArrayBuffer?n:t.defaults.transformRequest[0](n,i)};var f=i.defer(),u=f.promise;return n.headers.__setXHR_=function(){return function(t){t&&(n.__XHR=t,n.xhrFn&&n.xhrFn(t),t.upload.addEventListener("progress",function(t){t.config=n;f.notify?f.notify(t):u.progress_fn&&r(function(){u.progress_fn(t)})},!1),t.upload.addEventListener("load",function(t){t.lengthComputable&&(t.config=n,f.notify?f.notify(t):u.progress_fn&&r(function(){u.progress_fn(t)}))},!1))}},t(n).then(function(n){f.resolve(n)},function(n){f.reject(n)},function(n){f.notify(n)}),u.success=function(t){return u.then(function(i){t(i.data,i.status,i.headers,n)}),u},u.error=function(t){return u.then(null,function(i){t(i.data,i.status,i.headers,n)}),u},u.progress=function(n){return u.progress_fn=n,u.then(null,null,function(t){n(t)}),u},u.abort=function(){return n.__XHR&&r(function(){n.__XHR.abort()}),u},u.xhr=function(t){return n.xhrFn=function(n){return function(){n&&n.apply(u,arguments);t.apply(u,arguments)}}(n.xhrFn),u},u}this.upload=function(t){return t.headers=t.headers||{},t.headers["Content-Type"]=undefined,t.transformRequest=t.transformRequest?angular.isArray(t.transformRequest)?t.transformRequest:[t.transformRequest]:[],t.transformRequest.push(function(i){var f=new FormData,u={},r,o,s,e;for(n in t.fields)t.fields.hasOwnProperty(n)&&(u[n]=t.fields[n]);if(i&&(u.data=i),t.formDataAppender)for(n in u)u.hasOwnProperty(n)&&t.formDataAppender(f,n,u[n]);else for(n in u)u.hasOwnProperty(n)&&(r=u[n],r!==undefined&&(angular.isDate(r)&&(r=r.toISOString()),angular.isString(r)?f.append(n,r):t.sendObjectsAsJsonBlob&&angular.isObject(r)?f.append(n,new Blob([r],{type:"application/json"})):f.append(n,JSON.stringify(r))));if(t.file!=null)if(o=t.fileFormDataName||"file",angular.isArray(t.file))for(s=angular.isString(o),e=0;e<t.file.length;e++)f.append(s?o:o[e],t.file[e],t.fileName&&t.fileName[e]||t.file[e].name);else f.append(o,t.file,t.fileName||t.file.name);return f}),u(t)};this.http=function(n){return u(n)}}]);t.directive("ngfSelect",["$parse","$timeout","$compile",function(n,t,i){return{restrict:"AEC",require:"?ngModel",link:function(r,u,f,e){o(r,u,f,e,n,t,i)}}}]);t.directive("ngfDrop",["$parse","$timeout","$location",function(n,t,i){return{restrict:"AEC",require:"?ngModel",link:function(r,u,f,e){s(r,u,f,e,n,t,i)}}}]);t.directive("ngfNoFileDrop",function(){return function(n,t){i()&&t.css("display","none")}});t.directive("ngfDropAvailable",["$parse","$timeout",function(n,t){return function(r,u,f){if(i()){var e=n(f.ngfDropAvailable);t(function(){e(r);e.assign&&e.assign(r,!0)})}}}]);t.directive("ngfThumbnail",["$parse","$timeout",function(n,t){return{restrict:"AE",link:function(n,i,r){window.FileReader&&n.$watch(r.ngfThumbnail,function(n){n&&n.type.indexOf("image")>-1?t(function(){var r=new FileReader;r.readAsDataURL(n);r.onload=function(n){t(function(){i.attr("src",n.target.result)})}}):i.attr("src","")})}}}])})();